(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{441:function(e,t,o){"use strict";o.r(t);var n=o(322),r=o(327);function a(e){return new Promise(t=>{setTimeout(t,e)})}async function i(){return await a(500),fetch("/products.json").then(e=>e.json())}async function l(){return await a(500),fetch("/addr.json").then(e=>e.json())}async function c(){return(await l()).filter(e=>e.province&&!e.city&&!e.area&&!e.town)}var d=o(66);var p=Object(n.b)({name:"WorktableWrapper",components:{Worktable:r.a},setup(){const e=[{field:"seq",title:"序号",value:e=>e.parent?`${e.parent.index+1}-${e.index+1}`:e.index+1,width:80},{field:"{productCode, productName}",type:"object",title:"商品",component:"async-select",width:180,componentProps:{optionInValue:!0,labelProp:"productName",valueProp:"productCode",remoteMethod:i,clearable:!0},required:!0,rule:{validator(e){if(!e.productCode)throw"请选择商品"}}},{field:"productCode",title:"商品编码",width:140},{field:"isGroup",type:"boolean",title:"是否组合商品",width:120,component:e=>e.parent?"render":d.Checkbox,componentProps:{render:e=>{if(e.parent)return"-"}},effects:{onFieldValueChange:(e,t)=>{e||t.removeAllRow()}},default:!1},{field:"count",type:"number",title:"数量",width:140,component:"Input",componentProps:{type:"number",placeholder:"请输入"},required:!0,requiredMessage:"缺少数量",rule:{validator(e,t){if(e<=0)throw"要求是正数";if(t.data.isGroup&&e>1)throw"组合商品数量不能大于1"}},default:10},{field:"productionProvince",title:"出产省份",width:160,component:"async-select",componentProps:e=>({disabled:!e.data.productCode,valueProp:"province",labelProp:"name",clearable:!0,remoteMethod:c}),effects:{onFieldValueChange(e,t){t.reset("productionCity"),t.setComponentProps("productionCity",{options:[]}),t.setLoading("productionCity",!0),async function(e){return(await l()).filter(t=>t.province==e&&t.city&&!t.area&&!t.town)}(e).then(e=>t.setComponentProps("productionCity",{options:e})).finally(()=>t.setLoading("productionCity",!1))}}},{field:"productionCity",title:"出产城市",width:160,component:"Select",componentProps:e=>({disabled:!e.data.productionProvince,valueProp:"city",labelProp:"name",clearable:!0}),effects:{onFieldValueChange(e,t){t.reset("productionArea"),t.setComponentProps("productionArea",{options:[]}),t.setLoading("productionArea",!0),async function(e,t){return(await l()).filter(o=>o.province==e&&o.city==t&&o.area&&!o.town)}(t.data.productionProvince,e).then(e=>t.setComponentProps("productionArea",{options:e})).finally(()=>t.setLoading("productionArea",!1))}}},{field:"productionArea",title:"出产县区",width:160,component:"Select",componentProps:e=>({disabled:!e.data.productionCity,valueProp:"area",labelProp:"name",clearable:!0})},{field:"[startDate, endDate]",title:"保质期",type:"array",width:220,asterisk:!0,component:d.DatePicker,componentProps:{style:"width: 200px",type:"daterange",size:"mini",clearable:!0},rule:{required:!0,len:2,validator:e=>!!(e&&e[0]&&e[1]),message:"该字段必填"}},{field:"creator",title:"创建人",width:120,component:"Input",componentProps:{placeholder:"请输入",clearable:!0}},{field:"action",virtual:!0,title:"操作",width:120,render(e){const t=Object(n.d)(d.Button,{attrs:{type:"text",size:"mini"},on:{click:()=>{e.addRow(),Object(n.f)(()=>e.toggleExpansion(!0))}}},"添加散件"),o=Object(n.d)(d.Button,{attrs:{type:"text",size:"mini"},style:{color:"red"},on:{click:()=>e.removeSelf()}},"删除");return[e.data.isGroup&&t,o]}}],t=Object(r.b)({columns:e,layout:{pagination:!0},initialData:[{isGroup:!0}]});return{doSave:function(){const e=t.getData();console.log("[save:data]: ",e)},doValidate:function(){t.validate().catch(()=>{})},doAdd:function(){t.add(),t.gotoLastPage()}}}}),s=o(14),u=Object(s.a)(p,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("div",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.doSave}},[e._v("保存（已打印在控制台）")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.doValidate}},[e._v("校验")]),e._v(" "),t("el-button",{attrs:{size:"small"},on:{click:e.doAdd}},[e._v("添加商品")])],1),e._v(" "),t("Worktable",{staticStyle:{"margin-top":"20px"},attrs:{border:""}})],1)}),[],!1,null,null,null);t.default=u.exports}}]);